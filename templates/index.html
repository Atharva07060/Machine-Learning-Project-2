<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CVScanner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 2rem; background-color: #f8f9fa; }
        .card { margin-bottom: 1.5rem; }
        textarea { white-space: pre-wrap; }
    </style>
</head>
<body>
<div class="container">
    <h1 class="mb-4 text-center">🧠 CVScanner</h1>

    <form method="POST" enctype="multipart/form-data" class="card p-4 shadow-sm">
        <div class="mb-3">
            <label for="resume" class="form-label">Upload Resume (PDF)</label>
            <input type="file" class="form-control" name="resume" required>
        </div>
        <div class="mb-3">
            <label for="role" class="form-label">Select Job Role</label>
            <select class="form-select" name="role" required>
                {% for r in job_roles %}
                    <option value="{{ r }}" {% if r == role %}selected{% endif %}>{{ r }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Analyze</button>
    </form>

    {% if resume_text %}
    <div class="card p-4 shadow-sm">
        <h4>📊 ATS Score: {{ ats_score }} / 100</h4>

        <h5 class="mt-3">📈 Missing Skills</h5>
        {% if missing_skills %}
            <ul>
                {% for skill in missing_skills %}
                    <li>{{ skill }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-success">Your resume covers all key skills!</p>
        {% endif %}

        <h5 class="mt-3">🎓 Tutorials</h5>
        {% for skill, links in tutorials.items() %}
            {% for link in links %}
                <p><a href="{{ link }}" target="_blank">{{ skill }} Tutorial</a></p>
            {% endfor %}
        {% endfor %}

        <h5 class="mt-3">📏 Readability</h5>
        <ul>
            <li>Word Count: {{ readability.word_count }}</li>
            <li>Flesch Score: {{ readability.flesch_score }}</li>
            <li>Grade Level: {{ readability.grade_level }}</li>
        </ul>

        <h5 class="mt-3">🏷️ Resume Sections</h5>
        <p>{{ sections | join(', ') }}</p>

        <h5 class="mt-3">🏢 Named Entities</h5>
        <ul>
            <li><strong>Organizations:</strong> {{ entities.ORG | join(', ') }}</li>
            <li><strong>Locations:</strong> {{ entities.GPE | join(', ') }}</li>
            <li><strong>Education:</strong> {{ entities.EDUCATION | join(', ') }}</li>
        </ul>

        <a href="/download?path={{ report_path }}" class="btn btn-success mt-3">📥 Download Report</a>
    </div>
    {% endif %}
</div>
</body>
</html>
